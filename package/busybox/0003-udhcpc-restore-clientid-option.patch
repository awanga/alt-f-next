--- a/networking/udhcp/dhcpc.c	2023-01-03 14:14:43.000000000 +0000
+++ b/networking/udhcp/dhcpc.c	2023-09-13 20:59:43.628547350 +0000
@@ -54,6 +54,7 @@
 
 #if ENABLE_LONG_OPTS
 static const char udhcpc_longopts[] ALIGN1 =
+	"clientid\0"       Required_argument "c"
 	"clientid-none\0"  No_argument       "C"
 	"vendorclass\0"    Required_argument "V" //deprecated
 	"fqdn\0"           Required_argument "F"
@@ -81,27 +82,28 @@
 #endif
 /* Must match getopt32 option string order */
 enum {
-	OPT_C = 1 << 0,
-	OPT_V = 1 << 1,
-	OPT_F = 1 << 2,
-	OPT_i = 1 << 3,
-	OPT_n = 1 << 4,
-	OPT_p = 1 << 5,
-	OPT_q = 1 << 6,
-	OPT_R = 1 << 7,
-	OPT_r = 1 << 8,
-	OPT_s = 1 << 9,
-	OPT_T = 1 << 10,
-	OPT_t = 1 << 11,
-	OPT_S = 1 << 12,
-	OPT_A = 1 << 13,
-	OPT_O = 1 << 14,
-	OPT_o = 1 << 15,
-	OPT_x = 1 << 16,
-	OPT_f = 1 << 17,
-	OPT_B = 1 << 18,
+	OPT_c = 1 << 0,
+	OPT_C = 1 << 1,
+	OPT_V = 1 << 2,
+	OPT_F = 1 << 3,
+	OPT_i = 1 << 4,
+	OPT_n = 1 << 5,
+	OPT_p = 1 << 6,
+	OPT_q = 1 << 7,
+	OPT_R = 1 << 8,
+	OPT_r = 1 << 9,
+	OPT_s = 1 << 10,
+	OPT_T = 1 << 11,
+	OPT_t = 1 << 12,
+	OPT_S = 1 << 13,
+	OPT_A = 1 << 14,
+	OPT_O = 1 << 15,
+	OPT_o = 1 << 16,
+	OPT_x = 1 << 17,
+	OPT_f = 1 << 18,
+	OPT_B = 1 << 19,
 /* The rest has variable bit positions, need to be clever */
-	OPTBIT_B = 18,
+	OPTBIT_B = 19,
 	USE_FOR_MMU(             OPTBIT_b,)
 	IF_FEATURE_UDHCPC_ARPING(OPTBIT_a,)
 	IF_FEATURE_UDHCP_PORT(   OPTBIT_P,)
@@ -1163,7 +1165,7 @@
 //usage:#define udhcpc_trivial_usage
 //usage:       "[-fbq"IF_UDHCP_VERBOSE("v")"RB]"IF_FEATURE_UDHCPC_ARPING(" [-a[MSEC]]")" [-t N] [-T SEC] [-A SEC|-n]\n"
 //usage:       "	[-i IFACE]"IF_FEATURE_UDHCP_PORT(" [-P PORT]")" [-s PROG] [-p PIDFILE]\n"
-//usage:       "	[-oC] [-r IP] [-V VENDOR] [-F NAME] [-x OPT:VAL]... [-O OPT]..."
+//usage:       "	[-oC] [-r IP] [-c CID] [-V VENDOR] [-F NAME] [-x OPT:VAL]... [-O OPT]..."
 //usage:#define udhcpc_full_usage "\n"
 //usage:     "\n	-i IFACE	Interface to use (default "CONFIG_UDHCPC_DEFAULT_INTERFACE")"
 //usage:	IF_FEATURE_UDHCP_PORT(
@@ -1198,6 +1200,7 @@
 //usage:     "\n	-F NAME		Ask server to update DNS mapping for NAME"
 //usage:     "\n	-V VENDOR	Vendor identifier (default 'udhcp VERSION')"
 //usage:     "\n	-C		Don't send MAC as client identifier"
+//usage:     "\n	-c,--clientid=CLIENTID	Set client identifier - type is first char"
 //usage:	IF_UDHCP_VERBOSE(
 //usage:     "\n	-v		Verbose"
 //usage:	)
@@ -1209,7 +1212,7 @@
 int udhcpc_main(int argc UNUSED_PARAM, char **argv)
 {
 	uint8_t *message;
-	const char *str_V, *str_F, *str_r;
+	const char *str_c, *str_V, *str_F, *str_r;
 	IF_FEATURE_UDHCPC_ARPING(const char *str_a = "2000";)
 	IF_FEATURE_UDHCP_PORT(char *str_P;)
 	uint8_t *clientid_mac_ptr;
@@ -1244,7 +1247,7 @@
 	/* Parse command line */
 	opt = getopt32long(argv, "^"
 		/* O,x: list; -T,-t,-A take numeric param */
-		"CV:F:i:np:qRr:s:T:+t:+SA:+O:*ox:*fB"
+		"c:CV:F:i:np:qRr:s:T:+t:+SA:+O:*ox:*fB"
 		USE_FOR_MMU("b")
 		IF_FEATURE_UDHCPC_ARPING("a::")
 		IF_FEATURE_UDHCP_PORT("P:")
@@ -1252,6 +1255,7 @@
 		"\0" IF_UDHCP_VERBOSE("vv") /* -v is a counter */
 		, udhcpc_longopts
 		, &str_V, &str_F
+		, &str_c
 		, &client_data.interface, &client_data.pidfile /* i,p */
 		, &str_r /* r */
 		, &client_data.script /* s */
@@ -1328,7 +1332,11 @@
 	}
 
 	clientid_mac_ptr = NULL;
-	if (!(opt & OPT_C) && !udhcp_find_option(client_data.options, DHCP_CLIENT_ID, /*dhcpv6:*/ 0)) {
+	if (opt & OPT_c) {
+		unsigned len = strnlen(str_c, 254);
+		clientid_mac_ptr = udhcp_insert_new_option(&client_data.options, DHCP_CLIENT_ID, len, 0);
+		memcpy(clientid_mac_ptr + OPT_DATA, str_c, len); /* do not store NUL byte */
+	} else if (!(opt & OPT_C) && !udhcp_find_option(client_data.options, DHCP_CLIENT_ID, /*dhcpv6:*/ 0)) {
 		/* not suppressed and not set, create default client ID */
 		clientid_mac_ptr = udhcp_insert_new_option(
 				&client_data.options, DHCP_CLIENT_ID,
